import { Client } from "@notionhq/client";
import type { ClientOptions } from "@notionhq/client/build/src/Client.js";

export type CapabilityContext = {
	/** Notion API SDK client for this execution. */
	notion: Client;
};

export function createCapabilityContext(): CapabilityContext {
	const options: ClientOptions = {};

	if (process.env.NOTION_API_BASE_URL) {
		options.baseUrl = process.env.NOTION_API_BASE_URL;
	}

	if (process.env.NOTION_API_TOKEN) {
		options.auth = process.env.NOTION_API_TOKEN;
	}

	const notion = new Client(options);

	return { notion };
}
